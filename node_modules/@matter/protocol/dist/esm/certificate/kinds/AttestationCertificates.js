/**
 * @license
 * Copyright 2022-2025 Matter.js Authors
 * SPDX-License-Identifier: Apache-2.0
 */
import { DerBitString, DerCodec, X962 } from "#general";
import { assertCertificateDerSize } from "./common.js";
import { X509Base } from "./X509Base.js";
class AttestationBaseCertificate extends X509Base {
  /**
   * Sign the certificate using the provided crypto and key.
   * If the certificate is already signed, it throws a CertificateError.
   */
  async sign(crypto, key) {
    this.signature = await crypto.signEcdsa(key, this.asUnsignedAsn1(), "der");
  }
  /**
   * Returns the signed certificate in ASN.1 DER format.
   * If the certificate is not signed, it throws a CertificateError.
   */
  asSignedAsn1() {
    const certificate = this.genericBuildAsn1Structure(this.cert);
    const certBytes = DerCodec.encode({
      certificate,
      signAlgorithm: X962.EcdsaWithSHA256,
      signature: DerBitString(this.signature)
    });
    assertCertificateDerSize(certBytes);
    return certBytes;
  }
}
class Paa extends AttestationBaseCertificate {
}
class Pai extends AttestationBaseCertificate {
}
class Dac extends AttestationBaseCertificate {
}
export {
  AttestationBaseCertificate,
  Dac,
  Paa,
  Pai
};
//# sourceMappingURL=AttestationCertificates.js.map
