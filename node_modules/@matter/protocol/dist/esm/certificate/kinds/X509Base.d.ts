/**
 * @license
 * Copyright 2022-2025 Matter.js Authors
 * SPDX-License-Identifier: Apache-2.0
 */
import { Crypto, DerType, Key } from "#general";
import { Unsigned } from "./common.js";
import { X509Certificate } from "./definitions/base.js";
/**
 * Abstract definition of a X.509 certificate that can be signed and converted to ASN.1 DER format.
 * It also provides two static methods to create a certificate signing request (CSR) and to extract the public key
 * from a CSR.
 */
export declare abstract class X509Base<CT extends X509Certificate> {
    #private;
    constructor(cert: CT | Unsigned<CT>);
    get cert(): Unsigned<CT>;
    get isSigned(): boolean;
    /**
     * Get the signature of the certificate.
     * If the certificate is not signed, it throws a CertificateError.
     */
    get signature(): Uint8Array;
    /**
     * Set the signature of the certificate.
     * If the certificate is already signed, it throws a CertificateError.
     */
    set signature(signature: Uint8Array);
    /**
     * Sign the certificate using the provided crypto and key.
     * It throws a CertificateError if the certificate is already signed.
     */
    sign(crypto: Crypto, key: JsonWebKey): Promise<void>;
    /**
     * Convert the certificate to ASN.1 DER format without signature.
     */
    asUnsignedAsn1(): Uint8Array<ArrayBufferLike>;
    /**
     * Build the ASN.1 DER structure for the certificate.
     */
    protected genericBuildAsn1Structure({ serialNumber, notBefore, notAfter, issuer, subject, ellipticCurvePublicKey, extensions, }: Unsigned<CT>): {
        version: {
            _tag: number;
            _bytes: Uint8Array<ArrayBuffer>;
        };
        serialNumber: {
            _type: DerType;
            _raw: any;
        };
        signatureAlgorithm: any;
        issuer: {
            [field: string]: any[];
        };
        validity: {
            notBefore: Date;
            notAfter: Date;
        };
        subject: {
            [field: string]: any[];
        };
        publicKey: {
            type: {
                algorithm: {
                    _tag: number;
                    _bytes: Uint8Array<ArrayBuffer>;
                };
                curve: {
                    _tag: number;
                    _bytes: Uint8Array<ArrayBuffer>;
                };
            };
            bytes: {
                _tag: number;
                _bytes: Uint8Array<ArrayBufferLike>;
                _padding: number;
            };
        };
        extensions: {
            _tag: number;
            _bytes: Uint8Array<ArrayBuffer>;
        };
    };
    /**
     * Create a Certificate Signing Request (CSR) in ASN.1 DER format.
     */
    static createCertificateSigningRequest(crypto: Crypto, key: Key): Promise<Uint8Array<ArrayBufferLike>>;
    /**
     * Extract the public key from a Certificate Signing Request (CSR) in ASN.1 DER format.
     */
    static getPublicKeyFromCsr(crypto: Crypto, encodedCsr: Uint8Array): Promise<Uint8Array<ArrayBufferLike>>;
}
//# sourceMappingURL=X509Base.d.ts.map